<p id="notice"><%= notice %></p>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      <h2>
        <strong><%= @event.title %></strong>
        <br>
        <%=link_to 'Add Event to Google Calendar', '/events/' + @event.id.to_s + '/saveEvent', :method => :post, class: "lnk pri" %>
      </h2>

      <!-- <div class="event_image" style="background-image: url('<%= @event.image.url %>') cover no-repeat"></div> -->

      <div class="gradient"></div>
      <img class="img-responsive event_image" src="<% image_tag (@event.image.url(:xlarge)) %>" ></img>

    </div>
  </div>

  <div class="row middle">
    <div class="col-md-4 text-center" style="z-index:10000">

        <p>
          <strong>Description:</strong>
          <%= @event.description %>
        </p>

        <p>
          <strong>Start Date:</strong>
          <%= @event.start_date %>
        </p>

        <p>
          <strong>End Date:</strong>
          <%= @event.end_date %>
        </p>

        <p>
          <strong>Location:</strong>
          <%= @event.location %>
        </p>

        <p id="latitude" type="hidden" value="<%= @event.latitude %>">
        </p>

        <p id="longitude" type ="hidden" value="<%= @event.longitude %>">
        </p>

        <p>
          <strong>Start Time:</strong>
          <%= @event.start_time.strftime("%I:%M %p") %>
        </p>
        <p>
          <strong>End Time:</strong>
          <%= @event.end_time.strftime("%I:%M %p") %>
        </p>

        <strong>Tags:</strong>
        <% if @event.tags.any? %>
          <p>
            <% @event.tags.each do |tag| %>
              <%= tag.name %>
            <% end %>
          </p>
        <% else %>
          <p>none available</p>
        <% end %>


    </div>
    <div class="col-md-4 text-center" style="z-index:10000">
      <h3>People Attending This Event</h3>

      <table class="attendance_list">
        <thead>
          <tr>
            <th>Username</th>
          </tr>
        </thead>
        <tbody>
          <% if !@eventees.nil? %>
            <% @eventees.each do |eventee| %>
            <tr>
              <td><%= eventee.username%></td>
              <td><%= link_to 'Show', @user, class: "lnk thi" %></td>
            </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>


      <% if user_signed_in? %>
        <%  if Attendance.where(:user_id => current_user.id, :event_id => @event.id).blank? %>
          <%= link_to 'Attend', '/events/' + @event.id.to_s + '/attend', :method => :post %>
        <% else %>
          <%= link_to 'Unattend', '/events/' + @event.id.to_s + '/unattend', :method => :delete %>
        <% end %>
      <% end %>

      <% if user_signed_in? %>
        <% if @event.user_id == current_user.id %>
          | <%= link_to 'Edit', edit_event_path(@event), class: "lnk sec" %>
        <% end %>
      <% end %>


    </div>
    <div class="col-md-4" style="z-index:10000">
      <div id="show-map">
      </div>
    </div>
  </div>
</div>

<script>
  function initMap() {
    var latitude = document.getElementById("latitude").getAttribute("value");
    var longitude = document.getElementById("longitude").getAttribute("value");
    var location = new google.maps.LatLng(latitude,longitude);
    var mapOptions = { zoom:13, center: location }
    var map = new google.maps.Map(document.getElementById("show-map"), mapOptions);
    var icon = document.getElementById("")
    var marker = new google.maps.Marker({
      position: location,
      animation: google.maps.Animation.BOUNCE,
      icon: "<%= asset_path 'icons/funfinder-logo8.png' %>",
      map: map
    });
  }
  google.maps.event.addDomListener(window, "load", initMap);
</script>
